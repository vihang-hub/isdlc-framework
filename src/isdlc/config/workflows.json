{
  "version": "1.0.0",
  "description": "Workflow definitions for iSDLC - each workflow defines a fixed, non-skippable phase sequence",

  "workflows": {
    "feature": {
      "label": "New Feature",
      "command": "/sdlc feature",
      "description": "Implement a new feature end-to-end",
      "phases": [
        "01-requirements",
        "02-architecture",
        "03-design",
        "04-test-strategy",
        "05-implementation",
        "10-local-testing",
        "06-testing",
        "09-cicd",
        "07-code-review"
      ],
      "gate_mode": "strict",
      "options": {
        "atdd_mode": {
          "description": "Enable ATDD with test.skip() scaffolds and Given-When-Then AC mapping",
          "default": false,
          "flag": "--atdd"
        }
      },
      "agent_modifiers": {
        "01-requirements": { "scope": "feature", "artifact_prefix": "REQ" },
        "02-architecture": { "scope": "impact-assessment" },
        "04-test-strategy": {
          "_when_atdd_mode": {
            "generate_skipped_tests": true,
            "require_given_when_then_ac": true,
            "create_atdd_checklist": true
          }
        },
        "05-implementation": {
          "_when_atdd_mode": {
            "track_red_green_transitions": true,
            "require_priority_order": true,
            "all_priorities_must_pass": true
          }
        },
        "10-local-testing": { "scope": "local" }
      },
      "requires_branch": true
    },

    "fix": {
      "label": "Bug Fix",
      "command": "/sdlc fix",
      "description": "Fix a bug or defect with TDD",
      "phases": [
        "01-requirements",
        "04-test-strategy",
        "05-implementation",
        "10-local-testing",
        "06-testing",
        "09-cicd",
        "07-code-review"
      ],
      "gate_mode": "strict",
      "options": {
        "atdd_mode": {
          "description": "Enable ATDD with test.skip() scaffolds and Given-When-Then AC mapping",
          "default": false,
          "flag": "--atdd"
        }
      },
      "agent_modifiers": {
        "01-requirements": {
          "scope": "bug-report",
          "artifact_prefix": "BUG",
          "require_external_id": true
        },
        "04-test-strategy": {
          "_when_atdd_mode": {
            "generate_skipped_tests": true,
            "require_given_when_then_ac": true,
            "create_atdd_checklist": true
          }
        },
        "05-implementation": {
          "require_failing_test_first": true,
          "_when_atdd_mode": {
            "track_red_green_transitions": true,
            "require_priority_order": true,
            "all_priorities_must_pass": true
          }
        },
        "10-local-testing": { "scope": "local" }
      },
      "requires_branch": true
    },

    "test-run": {
      "label": "Run Tests",
      "command": "/sdlc test run",
      "description": "Execute existing automation tests",
      "phases": [
        "10-local-testing",
        "06-testing"
      ],
      "gate_mode": "strict",
      "agent_modifiers": {
        "10-local-testing": { "scope": "local" }
      },
      "options": {
        "test_type": {
          "prompt": "Which tests do you want to run?",
          "choices": ["unit", "system", "e2e"],
          "multi_select": true
        }
      },
      "requires_branch": false
    },

    "test-generate": {
      "label": "Generate Tests",
      "command": "/sdlc test generate",
      "description": "Create new tests for existing code",
      "phases": [
        "04-test-strategy",
        "05-implementation",
        "10-local-testing",
        "06-testing",
        "07-code-review"
      ],
      "gate_mode": "strict",
      "agent_modifiers": {
        "10-local-testing": { "scope": "local" }
      },
      "options": {
        "test_type": {
          "prompt": "What type of tests do you want to generate?",
          "choices": ["unit", "system", "e2e"],
          "multi_select": false
        }
      },
      "requires_branch": false
    },

    "full-lifecycle": {
      "label": "Full Lifecycle",
      "command": "/sdlc start",
      "description": "Complete SDLC for new projects or major work",
      "phases": [
        "01-requirements",
        "02-architecture",
        "03-design",
        "04-test-strategy",
        "05-implementation",
        "10-local-testing",
        "06-testing",
        "07-code-review",
        "08-validation",
        "09-cicd",
        "10-remote-build",
        "11-test-deploy",
        "12-production",
        "13-operations"
      ],
      "gate_mode": "strict",
      "agent_modifiers": {
        "10-local-testing": { "scope": "local" },
        "10-remote-build": { "scope": "remote" }
      },
      "requires_branch": true
    }
  },

  "rules": {
    "no_halfway_entry": true,
    "no_phase_skipping": true,
    "single_active_workflow_per_project": true,
    "require_cancellation_reason": true
  }
}
